<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rancho JP - Sistema de Comandas</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <!-- QZ Tray para impress√£o silenciosa -->
  <script src="https://cdn.jsdelivr.net/npm/qz-tray@2.2.4/qz-tray.min.js"></script>
  <link rel="stylesheet" href="css/style.css?v=1">
  <link rel="stylesheet" href="css/base/layout.css?v=1">
  <link rel="stylesheet" href="css/base/components.css?v=1">
  <link rel="stylesheet" href="css/base/print.css?v=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Outfit:wght@400;600;700;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>

  <div id="globalPrintHeader" class="global-print-element">
    <h1>Restaurante Rancho JP</h1>
  </div>

  <aside class="sidebar collapsed">
    <div class="sidebar-content">
      <button id="btnToggleSidebar" class="btn-toggle" title="Alternar Menu">
        <i class="fas fa-bars"></i>
      </button>

      <div class="sidebar-brand">
        <div class="brand-logo" style="display: flex; align-items: center; gap: 12px;">
          <div
            style="background: #38bdf8; width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #0f172a; font-size: 1.2rem; font-weight: 900; flex-shrink: 0;">
            R</div>
          <span class="brand-text">Rancho JP</span>
        </div>
      </div>

      <nav class="nav-menu">
        <a href="#" class="nav-item active" id="navDashboard">
          <span class="nav-icon">üìã</span>
          <span class="nav-text">Comandas</span>
        </a>
        <a href="#" class="nav-item" id="navProdutosSessao">
          <span class="nav-icon">üì¶</span>
          <span class="nav-text">Produtos</span>
        </a>
        <a href="#" class="nav-item" id="navColaboradores">
          <span class="nav-icon">üë•</span>
          <span class="nav-text">Colaboradores</span>
        </a>
        <a href="#" class="nav-item" id="navFinanceiro">
          <span class="nav-icon">üí∞</span>
          <span class="nav-text">Financeiro</span>
        </a>
        <a href="#" class="nav-item" id="navRelatorios">
          <span class="nav-icon">üìä</span>
          <span class="nav-text">Relat√≥rios</span>
        </a>
        <a href="#" class="nav-item" id="navFechamento">
          <span class="nav-icon">üîí</span>
          <span class="nav-text">Fechamento</span>
        </a>
      </nav>

      <div class="sidebar-footer"
        style="padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); margin-top: 20px;">
        <p style="font-size: 0.75rem; color: #64748b; margin: 0;">Rancho JP v2.0</p>
      </div>
    </div>
  </aside>

  <main class="main-content">
    <div id="sectionComandas">
      <header class="page-header">
        <div style="display: flex; align-items: center; gap: 15px;">
          <div class="page-title">
            <h1 id="mainTitle">Painel de Comandas</h1>
          </div>
        </div>
        <div class="quick-actions" id="headerActions">
          <div class="quick-input-group">
            <input type="number" id="quickNumero" placeholder="N¬∫ Comanda">
            <button class="btn-quick btn-add-comanda" id="btnConfirmarQuick">
              Abrir
            </button>
          </div>
        </div>
      </header>

      <div class="comandas-grid" id="comandasGrid">
        <!-- Grid preenchido via JS -->
      </div>
    </div>

    <!-- SESS√ÉO DE GERENCIAMENTO DE PRODUTOS (SUBSTITUI O GRID) -->
    <div id="sectionProdutos" class="hidden" style="padding: 20px;">
      <header class="page-header" style="margin-bottom: 25px;"></header>
      <div class="page-title">
        <h1 style="margin: 0; font-family: 'Outfit', sans-serif; font-size: 1.8rem; color: #1e293b; font-weight: 800;">
          Gerenciamento de Produtos</h1>
        <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">Cadastre e organize os itens do seu card√°pio</p>
      </div>
      </header>
      <div class="card"
        style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 15px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h3 style="margin: 0; font-size: 1.1rem; color: #1e293b;">Novo Produto / Filtro</h3>
          <button onclick="limparFiltrosSessao()"
            style="background: #f1f5f9; color: #64748b; padding: 6px 12px; font-size: 0.75rem; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">LIMPAR
            CAMPOS</button>
        </div>
        <div class="form-cadastro"
          style="display: flex; flex-direction: row; gap: 15px; align-items: flex-end; background: transparent; border: none; padding: 0; margin-bottom: 0;">
          <div style="flex: 0 0 120px;">
            <label
              style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">C√≥digo
              (3 dgt)</label>
            <input id="prodPageCodigo" placeholder="000" style="width: 100%;" maxlength="3">
          </div>
          <div style="flex: 1;">
            <label
              style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Descri√ß√£o
              do Produto</label>
            <input id="prodPageDescricao" placeholder="Ex: X-Salada, Coca-Cola..." style="width: 100%;">
          </div>
          <div style="flex: 0 0 150px;">
            <label
              style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Valor
              (R$)</label>
            <input id="prodPageValor" placeholder="0,00" type="number" step="0.01" style="width: 100%;">
          </div>
          <button id="btnSalvarProdutoPage" style="background: #10b981; padding: 12px 24px; font-weight: 700;">Salvar
            Produto</button>
        </div>
      </div>

      <div class="card"
        style="background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); overflow: hidden;">

        <table style="width: 100%; border-collapse: collapse;">
          <thead style="background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
            <tr>
              <th onclick="ordenarProdutos('grupo')"
                style="padding: 15px; text-align: center; width: 110px; cursor: pointer; user-select: none;">Grupo
              </th>
              <th onclick="ordenarProdutos('codigo')"
                style="padding: 15px; text-align: left; width: 100px; cursor: pointer; user-select: none;">C√≥digo
              </th>
              <th onclick="ordenarProdutos('descricao')"
                style="padding: 15px; text-align: left; cursor: pointer; user-select: none;">Descri√ß√£o</th>
              <th onclick="ordenarProdutos('valor')"
                style="padding: 15px; text-align: right; width: 120px; cursor: pointer; user-select: none;">Valor
              </th>
              <th style="padding: 15px; text-align: center; width: 100px;">Status</th>
              <th style="padding: 15px; text-align: center; width: 100px;">A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="tabelaProdutosPageBody">
            <!-- Preenchido via JS -->
          </tbody>
        </table>
      </div>
    </div>

    <div id="sectionColaboradores" class="hidden" style="padding: 20px;">
      <header class="page-header" style="margin-bottom: 25px;">
        <div class="page-title">
          <h1
            style="margin: 0; font-family: 'Outfit', sans-serif; font-size: 1.8rem; color: #1e293b; font-weight: 800;">
            Gest√£o de Colaboradores</h1>
          <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">Gerencie sua equipe, contatos e dados de
            pagamento</p>
        </div>
      </header>
      <div class="card"
        style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 15px;">
        <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="const content = document.getElementById('formColaboradorContent'); 
                      const icon = document.getElementById('iconToggleColab');
                      const isColabOpen = content.style.display === 'block';
                      content.style.display = isColabOpen ? 'none' : 'block';
                      icon.innerText = isColabOpen ? '‚ûï' : '‚ûñ';">
          <h3 style="margin: 0; font-size: 1.1rem; color: #1e293b; display: flex; align-items: center; gap: 10px;">
            <span id="iconToggleColab">‚ûï</span> Novo Colaborador
          </h3>
          <p style="margin: 0; font-size: 0.85rem; color: #64748b;">Clique para expandir/recolher</p>
        </div>

        <div id="formColaboradorContent"
          style="display: none; margin-top: 20px; border-top: 1px solid #f1f5f9; padding-top: 20px;">
          <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
            <button id="btnLimparColaborador"
              style="background: #f1f5f9; color: #64748b; padding: 6px 12px; font-size: 0.75rem; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700;">LIMPAR
              CAMPOS</button>
          </div>

          <div class="form-colaborador" style="display: grid; grid-template-columns: 2fr 2fr 1fr; gap: 15px;">
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Nome
                Completo *</label>
              <input id="colabNome" placeholder="Ex: Jo√£o Silva..." style="width: 100%;">
            </div>
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Endere√ßo</label>
              <input id="colabEndereco" placeholder="Rua, N√∫mero, Bairro..." style="width: 100%;">
            </div>
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Fun√ß√£o</label>
              <input id="colabFuncao" placeholder="Ex: Atendente, Cozinha..." style="width: 100%;">
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Contatos</label>
              <div id="listaInputsContatos" style="display: flex; flex-direction: column; gap: 5px;">
                <div style="display: flex; gap: 5px;">
                  <input class="colab-contato" placeholder="(00) 00000-0000" style="flex: 1;">
                  <button onclick="adicionarInput('listaInputsContatos', 'colab-contato')"
                    style="background: #38bdf8; padding: 0 10px; border-radius: 6px;">+</button>
                </div>
              </div>
            </div>
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Chaves
                PIX</label>
              <div id="listaInputsPix" style="display: flex; flex-direction: column; gap: 5px;">
                <div style="display: flex; gap: 5px;">
                  <input class="colab-pix" placeholder="Email, CPF ou Chave..." style="flex: 1;">
                  <button onclick="adicionarInput('listaInputsPix', 'colab-pix')"
                    style="background: #38bdf8; padding: 0 10px; border-radius: 6px;">+</button>
                </div>
              </div>
            </div>
          </div>

          <div style="margin-top: 20px; display: flex; justify-content: flex-end;">
            <button id="btnSalvarColaborador"
              style="background: #10b981; padding: 12px 24px; font-weight: 700; color: white; border-radius: 8px; border: none; cursor: pointer;">Salvar
              Colaborador</button>
          </div>
        </div>
      </div>

      <div class="card"
        style="background: white; padding: 15px 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 15px; display: flex; gap: 15px; align-items: flex-end;">
        <div style="flex: 1;">
          <label
            style="display: block; font-size: 0.7rem; font-weight: 700; color: #64748b; margin-bottom: 5px; text-transform: uppercase;">Filtrar
            por Nome</label>
          <input type="text" id="filtroColabNome" placeholder="Buscar..."
            style="width: 100%; height: 35px; font-size: 0.9rem;" oninput="filtrarERenderizarColaboradores()">
        </div>
        <div style="flex: 1;">
          <label
            style="display: block; font-size: 0.7rem; font-weight: 700; color: #64748b; margin-bottom: 5px; text-transform: uppercase;">Filtrar
            por Fun√ß√£o</label>
          <input type="text" id="filtroColabFuncao" placeholder="Buscar..."
            style="width: 100%; height: 35px; font-size: 0.9rem;" oninput="filtrarERenderizarColaboradores()">
        </div>
        <button onclick="limparFiltrosColaboradores()"
          style="background: #f1f5f9; color: #64748b; padding: 8px 15px; font-size: 0.75rem; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700; height: 35px;">LIMPAR</button>
      </div>

      <div class="card"
        style="background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse;">
          <thead style="background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
            <tr>
              <th onclick="ordenarColaboradores('id')"
                style="padding: 15px; text-align: center; width: 60px; cursor: pointer; user-select: none;">ID</th>
              <th onclick="ordenarColaboradores('nome')"
                style="padding: 15px; text-align: left; cursor: pointer; user-select: none;">Nome</th>
              <th onclick="ordenarColaboradores('funcao')"
                style="padding: 15px; text-align: left; cursor: pointer; user-select: none;">Fun√ß√£o</th>
              <th style="padding: 15px; text-align: left;">Contatos</th>
              <th style="padding: 15px; text-align: left;">PIX</th>
              <th onclick="ordenarColaboradores('ativo')"
                style="padding: 15px; text-align: center; width: 100px; cursor: pointer; user-select: none;">Status</th>
            </tr>
          </thead>
          <tbody id="tabelaColaboradoresBody">
            <!-- Preenchido via JS -->
          </tbody>
        </table>
      </div>
    </div>

    <div id="sectionFinanceiro" class="hidden" style="padding: 20px;">
      <header class="page-header" style="margin-bottom: 25px;">
        <div class="page-title">
          <h1
            style="margin: 0; font-family: 'Outfit', sans-serif; font-size: 1.8rem; color: #1e293b; font-weight: 800;">
            Controle Financeiro</h1>
          <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">Lan√ßamentos de despesas, fornecedores e
            pagamentos gerais</p>
        </div>
      </header>
      <div class="card"
        style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 15px;">
        <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" onclick="const content = document.getElementById('formFinanceiroContent'); 
                      const icon = document.getElementById('iconToggleFin');
                      const isFinOpen = content.style.display === 'block';
                      content.style.display = isFinOpen ? 'none' : 'block';
                      icon.innerText = isFinOpen ? '‚ûï' : '‚ûñ';">
          <h3 style="margin: 0; font-size: 1.1rem; color: #1e293b; display: flex; align-items: center; gap: 10px;">
            <span id="iconToggleFin">‚ûï</span> Novo Pagamento / Registro
          </h3>
          <p style="margin: 0; font-size: 0.85rem; color: #64748b;">Lan√ßamento de mercadorias, servi√ßos e outros</p>
        </div>

        <div id="formFinanceiroContent"
          style="display: none; margin-top: 20px; border-top: 1px solid #f1f5f9; padding-top: 20px;">
          <div class="form-grid"
            style="display: grid; grid-template-columns: 1fr 2fr 2fr 1fr; gap: 15px; align-items: flex-end;">
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Data</label>
              <input type="date" id="finData" style="width: 100%;">
            </div>
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Nome
                / Fornecedor *</label>
              <input type="text" id="finNome" placeholder="Ex: Panificadora..." style="width: 100%;">
            </div>
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Servi√ßo
                / Produto *</label>
              <input type="text" id="finServico" placeholder="Ex: P√£o de Hamb√∫rguer..." style="width: 100%;">
            </div>
            <div>
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Valor
                (R$)</label>
              <input type="number" step="0.01" id="finValor" placeholder="0,00" style="width: 100%;">
            </div>
          </div>
          <div style="margin-top: 15px; display: flex; gap: 15px; align-items: flex-end;">
            <div style="flex: 1; max-width: 300px;">
              <label
                style="display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 8px; text-transform: uppercase;">Forma
                de Pagamento</label>
              <input type="text" id="finForma" placeholder="Ex: Pix, Dinheiro, Boleto..." style="width: 100%;">
            </div>
            <div
              style="display: flex; align-items: center; gap: 8px; background: #f8fafc; padding: 8px 12px; border-radius: 8px; border: 1px solid #e2e8f0; height: 42px;">
              <input type="checkbox" id="finPago" checked style="width: 18px; height: 18px; cursor: pointer;">
              <label for="finPago"
                style="font-size: 0.85rem; font-weight: 700; color: #1e293b; cursor: pointer;">PAGO</label>
            </div>
            <button id="btnSalvarFin"
              style="background: #10b981; padding: 0 24px; height: 42px; font-weight: 700; color: white; border-radius: 8px; border: none; cursor: pointer;">Lan√ßar
              Pagamento</button>
          </div>
        </div>
      </div>

      <div class="card"
        style="background: white; padding: 15px 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 15px; display: flex; gap: 15px; align-items: flex-end;">
        <div style="flex: 1;">
          <label
            style="display: block; font-size: 0.7rem; font-weight: 700; color: #64748b; margin-bottom: 5px; text-transform: uppercase;">Nome
            / Fornecedor</label>
          <input type="text" id="filtroFinNome" placeholder="Buscar..."
            style="width: 100%; height: 35px; font-size: 0.9rem;" oninput="filtrarERenderizarFinanceiro()">
        </div>
        <div style="flex: 1;">
          <label
            style="display: block; font-size: 0.7rem; font-weight: 700; color: #64748b; margin-bottom: 5px; text-transform: uppercase;">Servi√ßo
            / Produto</label>
          <input type="text" id="filtroFinServico" placeholder="Buscar..."
            style="width: 100%; height: 35px; font-size: 0.9rem;" oninput="filtrarERenderizarFinanceiro()">
        </div>
        <button onclick="limparFiltrosFinanceiro()"
          style="background: #f1f5f9; color: #64748b; padding: 8px 15px; font-size: 0.75rem; border-radius: 6px; border: 1px solid #e2e8f0; font-weight: 700; height: 35px;">LIMPAR</button>
      </div>

      <div class="card"
        style="background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse;">
          <thead style="background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
            <tr>
              <th onclick="ordenarFinanceiro('data')"
                style="padding: 15px; text-align: left; width: 120px; cursor: pointer; user-select: none;">Data</th>
              <th onclick="ordenarFinanceiro('nome')"
                style="padding: 15px; text-align: left; cursor: pointer; user-select: none;">Nome</th>
              <th onclick="ordenarFinanceiro('item_servico')"
                style="padding: 15px; text-align: left; cursor: pointer; user-select: none;">Servi√ßo/Produto</th>
              <th style="padding: 15px; text-align: left;">Forma</th>
              <th onclick="ordenarFinanceiro('valor')"
                style="padding: 15px; text-align: right; width: 150px; cursor: pointer; user-select: none;">Valor</th>
              <th style="padding: 15px; text-align: center; width: 100px; white-space: nowrap;">Pago?</th>
              <th style="padding: 15px; text-align: center; width: 80px;">A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="tabelaFinanceiroBody">
            <!-- Preenchido via JS -->
          </tbody>
        </table>
      </div>
    </div>

    <div id="sectionFechamento" class="hidden" style="padding: 20px;">
      <header class="page-header" style="margin-bottom: 25px;">
        <div class="page-title">
          <h1
            style="margin: 0; font-family: 'Outfit', sans-serif; font-size: 1.8rem; color: #1e293b; font-weight: 800;">
            Fechamento Di√°rio</h1>
          <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">Insira os valores das maquininhas e dinheiro
            para confer√™ncia</p>
        </div>
      </header>

      <div class="card"
        style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-top: 20px; overflow-x: auto;">

        <!-- Tabela de M√°quinas -->
        <h3 style="margin: 0 0 15px 0; font-size: 0.9rem; color: #64748b; text-transform: uppercase;">üí≥ Valores das
          Maquininhas</h3>
        <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
          <thead>
            <tr style="text-align: left; border-bottom: 2px solid #f1f5f9;">
              <th style="padding: 10px; font-size: 0.75rem; color: #64748b; text-transform: uppercase;">M√°quina</th>
              <th style="padding: 10px; font-size: 0.75rem; color: #64748b; text-transform: uppercase; width: 180px;">
                Cr√©dito (R$)</th>
              <th style="padding: 10px; font-size: 0.75rem; color: #64748b; text-transform: uppercase; width: 180px;">
                D√©bito (R$)</th>
              <th style="padding: 10px; font-size: 0.75rem; color: #64748b; text-transform: uppercase; width: 180px;">
                Pix (R$)</th>
              <th style="padding: 10px; width: 50px;"></th>
            </tr>
          </thead>
          <tbody id="tbodyMaquinasFechamento">
            <!-- Linhas de m√°quinas inseridas via JS -->
          </tbody>
          <tfoot>
            <tr style="background: #f8fafc; font-weight: 800; border-top: 2px solid #e2e8f0;">
              <td style="padding: 15px 10px; color: #1e293b;">SUBTOTAL MAQUININHAS</td>
              <td style="padding: 15px 10px; color: #3b82f6;" id="totalFechamentoCredito">R$ 0,00</td>
              <td style="padding: 15px 10px; color: #3b82f6;" id="totalFechamentoDebito">R$ 0,00</td>
              <td style="padding: 15px 10px; color: #3b82f6;" id="totalFechamentoPix">R$ 0,00</td>
              <td></td>
            </tr>
          </tfoot>
        </table>

        <button id="btnAdicionarMaquina"
          style="margin-top: 15px; background: #f1f5f9; color: #1e293b; border: 1px solid #e2e8f0; box-shadow: none;">
          + ADICIONAR M√ÅQUINA
        </button>

        <!-- Dinheiro e Voucher Fixos -->
        <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
          <h3 style="margin: 0 0 15px 0; font-size: 0.9rem; color: #64748b; text-transform: uppercase;">üíµ Outros
            Recebimentos</h3>
          <div style="display: flex; gap: 40px; flex-wrap: wrap;">
            <!-- Dinheiro -->
            <div style="display: flex; flex-direction: column; gap: 8px;">
              <label style="font-size: 0.8rem; color: #64748b; font-weight: 600;">DINHEIRO (R$)</label>
              <input type="text" id="fechamentoDinheiroInput" class="f-moeda" placeholder="R$ 0,00"
                style="width: 180px; border: 1px solid #e2e8f0; padding: 12px; border-radius: 8px; font-weight: 700; font-size: 1rem; text-align: right;">
            </div>
            <!-- Voucher -->
            <div style="display: flex; flex-direction: column; gap: 8px;">
              <label style="font-size: 0.8rem; color: #64748b; font-weight: 600;">VOUCHER (R$)</label>
              <input type="text" id="fechamentoVoucherInput" class="f-moeda" placeholder="R$ 0,00"
                style="width: 180px; border: 1px solid #e2e8f0; padding: 12px; border-radius: 8px; font-weight: 700; font-size: 1rem; text-align: right;">
            </div>
          </div>
        </div>

        <!-- Total Geral e Bot√£o -->
        <div
          style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
          <div>
            <span style="font-size: 0.85rem; color: #64748b;">TOTAL GERAL:</span>
            <span id="totalFechamentoGeral"
              style="font-size: 1.4rem; font-weight: 800; color: #1e293b; margin-left: 10px;">R$ 0,00</span>
          </div>
          <button id="btnAbrirModalImpressaoFechamento"
            style="background: #3b82f6; color: white; padding: 15px 30px; font-weight: 800; border-radius: 12px; border: none; cursor: pointer; display: flex; align-items: center; gap: 10px;">
            <span>üñ®Ô∏è</span> PREPARAR IMPRESS√ÉO (F9)
          </button>
        </div>
      </div>
    </div>

    <!-- SESS√ÉO DE RELAT√ìRIOS -->
    <div id="sectionRelatorios" class="hidden" style="padding: 20px;">
      <header class="page-header" style="margin-bottom: 25px;">
        <div class="page-title">
          <h1
            style="margin: 0; font-family: 'Outfit', sans-serif; font-size: 1.8rem; color: #1e293b; font-weight: 800;">
            Relat√≥rios e An√°lises</h1>
          <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">Dashboards e an√°lise detalhada de vendas</p>
        </div>
      </header>

      <!-- Relat√≥rio: Vendas -->
      <div id="relAbaVendas" class="tab-content">
        <div class="card" style="background: white; padding: 25px; border-radius: 16px; margin-bottom: 20px;">

          <div style="display: flex; align-items: flex-end; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
            <div style="display: flex; gap: 10px; align-items: flex-end;">
              <div>
                <label
                  style="display:block; font-size:0.7rem; font-weight:700; color:#64748b; margin-bottom:5px;">IN√çCIO</label>
                <input type="date" id="relVendasInicio" style="height:35px;">
              </div>
              <div>
                <label
                  style="display:block; font-size:0.7rem; font-weight:700; color:#64748b; margin-bottom:5px;">FIM</label>
                <input type="date" id="relVendasFim" style="height:35px;">
              </div>
            </div>
            <div style="display: flex; gap: 10px; align-items: flex-end;">
              <div>
                <label
                  style="display:block; font-size:0.7rem; font-weight:700; color:#64748b; margin-bottom:5px;">BUSCAR
                  PRODUTO</label>
                <input type="text" id="relVendasBusca" placeholder="Nome ou C√≥digo..."
                  style="height:35px; width: 180px;">
              </div>
              <button onclick="carregarRelatorioVendas()"
                style="background:#3b82f6; color:white; padding:0 20px; height:35px; border-radius:8px; font-weight:700;">FILTRAR</button>
            </div>

            <div
              style="display: flex; gap: 8px; background: #f1f5f9; padding: 5px; border-radius: 10px; height: 45px; align-items: center;">
              <button class="btn-small-tab active" data-sub="geral" onclick="alternarSubAbaVendas('geral', this)">üìä
                Geral</button>
              <button class="btn-small-tab" data-sub="comandas" onclick="alternarSubAbaVendas('comandas', this)">üìù
                Comandas</button>
              <button class="btn-small-tab" data-sub="analitico" onclick="alternarSubAbaVendas('analitico', this)">üóíÔ∏è
                Anal√≠tico</button>
              <button class="btn-small-tab" data-sub="pagamentos" onclick="alternarSubAbaVendas('pagamentos', this)">üí≥
                Pagamentos</button>
              <button class="btn-small-tab" data-sub="fechamento" onclick="alternarSubAbaVendas('fechamento', this)">üîí
                Fechamento</button>
            </div>
          </div>

          <!-- SUB-ABA GERAL VENDAS -->
          <div id="subAbaVendasGeral">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div style="max-height: 450px; overflow-y: auto; border: 1px solid #f1f5f9; border-radius: 12px;">
                <table style="width: 100%; border-collapse: collapse;">
                  <thead style="background:#f8fafc; position:sticky; top:0; z-index: 10;">
                    <tr>
                      <th style="padding:10px; text-align:left; cursor:pointer;"
                        onclick="ordenarGeralVendas('descricao')">Produto ‚ÜïÔ∏è</th>
                      <th style="padding:10px; text-align:center; cursor:pointer;"
                        onclick="ordenarGeralVendas('total_qtd')">Qtd ‚ÜïÔ∏è</th>
                      <th style="padding:10px; text-align:right; padding-right:10px; cursor:pointer;"
                        onclick="ordenarGeralVendas('total_valor')">Total ‚ÜïÔ∏è</th>
                    </tr>
                  </thead>
                  <tbody id="tabelaRelVendasBody"></tbody>
                  <tfoot style="background: #f8fafc; border-top: 2px solid #e2e8f0; font-weight: 800;">
                    <tr>
                      <td style="padding: 12px;">TOTAL GERAL</td>
                      <td id="totalRelVendasQtd" style="text-align: center;">0</td>
                      <td id="totalRelVendasValor" style="text-align: right; padding-right: 10px;">R$ 0,00</td>
                    </tr>
                  </tfoot>
                </table>
              </div>
              <div
                style="background: #f8fafc; border-radius: 12px; padding: 15px; display: flex; align-items: center; justify-content: center;">
                <canvas id="chartVendas"></canvas>
              </div>
            </div>
          </div>

          <!-- SUB-ABA ANAL√çTICO VENDAS -->
          <div id="subAbaVendasAnalitico" class="hidden">
            <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto; max-height: 450px;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead style="background: #f8fafc; position: sticky; top: 0; z-index: 10;">
                  <tr>
                    <th style="padding: 10px; text-align: left; cursor: pointer; width: 150px; white-space: nowrap;"
                      onclick="ordenarAnaliticoVendas('data')">Data ‚ÜïÔ∏è</th>
                    <th style="padding: 10px; text-align: center; width: 90px; cursor: pointer;"
                      onclick="ordenarAnaliticoVendas('comanda_numero')">Comanda ‚ÜïÔ∏è</th>
                    <th style="padding: 10px; text-align: left;">Produto</th>
                    <th style="padding: 10px; text-align: center; width: 60px;">Qtd</th>
                    <th style="padding: 10px; text-align: right; width: 120px;">Valor (R$)</th>
                  </tr>
                </thead>
                <tbody id="tabelaRelVendasAnaliticoBody"></tbody>
              </table>
            </div>
          </div>

          <!-- SUB-ABA COMANDAS VENDAS -->
          <div id="subAbaVendasComandas" class="hidden">
            <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto; max-height: 450px;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead style="background: #f8fafc; position: sticky; top: 0; z-index: 10;">
                  <tr>
                    <th style="padding: 10px; text-align: left; cursor: pointer; width: 150px; white-space: nowrap;"
                      onclick="ordenarComandasVendas('data')">Data ‚ÜïÔ∏è</th>
                    <th style="padding: 10px; text-align: center; width: 100px; cursor: pointer;"
                      onclick="ordenarComandasVendas('numero')">Nr¬∫ Comanda ‚ÜïÔ∏è</th>
                    <th style="padding: 10px; text-align: left;">M√©todos</th>
                    <th style="padding: 10px; text-align: right; cursor: pointer; width: 120px;"
                      onclick="ordenarComandasVendas('total')">Total (R$) ‚ÜïÔ∏è</th>
                  </tr>
                </thead>
                <tbody id="tabelaRelVendasComandasBody"></tbody>
              </table>
            </div>
          </div>

          <!-- SUB-ABA FECHAMENTO VENDAS -->
          <div id="subAbaVendasFechamento" class="hidden">
            <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto; max-height: 450px;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead style="background: #f8fafc; position: sticky; top: 0; z-index: 10;">
                  <tr>
                    <th style="padding: 10px; text-align: left;">M√©todo de Pagamento</th>
                    <th style="padding: 10px; text-align: right; width: 200px;">Total (R$)</th>
                  </tr>
                </thead>
                <tbody id="tabelaRelVendasFechamentoBody"></tbody>
                <tfoot style="background: #f8fafc; border-top: 2px solid #e2e8f0; font-weight: 800;">
                  <tr>
                    <td style="padding: 12px;">TOTAL GERAL</td>
                    <td id="totalRelVendasFechamentoValor" style="text-align: right; padding-right: 10px;">R$ 0,00</td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>

          <!-- SUB-ABA PAGAMENTOS VENDAS (SA√çDAS) -->
          <div id="subAbaVendasPagamentos" class="hidden">
            <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto; max-height: 450px;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead style="background: #f8fafc; position: sticky; top: 0; z-index: 10;">
                  <tr>
                    <th style="padding: 10px; text-align: left;">Fornecedor / Nome</th>
                    <th style="padding: 10px; text-align: right; width: 200px;">Total Pago (R$)</th>
                  </tr>
                </thead>
                <tbody id="tabelaRelVendasPagamentosBody"></tbody>
                <tfoot style="background: #f8fafc; border-top: 2px solid #e2e8f0; font-weight: 800;">
                  <tr>
                    <td style="padding: 12px;">TOTAL DE PAGAMENTOS (SA√çDAS)</td>
                    <td id="totalRelVendasPagamentosValor" style="text-align: right; padding-right: 10px;">R$ 0,00</td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>

        </div>
      </div>

      <div id="sectionFluxoCaixa" class="hidden" style="padding: 20px;">
        <header class="page-header" style="margin-bottom: 25px;">
          <div class="page-title">
            <h1
              style="margin: 0; font-family: 'Outfit', sans-serif; font-size: 1.8rem; color: #1e293b; font-weight: 800;">
              Fluxo de Caixa</h1>
            <p style="margin: 5px 0 0; color: #64748b; font-size: 0.9rem;">An√°lise din√¢mica de entradas e sa√≠das</p>
          </div>
        </header>

        <div class="card" style="background: white; padding: 25px; border-radius: 16px; margin-bottom: 20px;">
          <div style="display: flex; align-items: flex-end; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
            <div style="display: flex; gap: 10px; align-items: flex-end;">
              <div>
                <label
                  style="display:block; font-size:0.7rem; font-weight:700; color:#64748b; margin-bottom:5px;">IN√çCIO</label>
                <input type="date" id="relFluxoInicio" style="height:35px;">
              </div>
              <div>
                <label
                  style="display:block; font-size:0.7rem; font-weight:700; color:#64748b; margin-bottom:5px;">FIM</label>
                <input type="date" id="relFluxoFim" style="height:35px;">
              </div>
              <button onclick="carregarRelatorioFluxo()"
                style="background:#3b82f6; color:white; padding:0 20px; height:35px; border-radius:8px; font-weight:700;">FILTRAR</button>
            </div>

            <div
              style="display: flex; gap: 8px; background: #f1f5f9; padding: 5px; border-radius: 10px; height: 45px; align-items: center;">
              <button class="btn-small-tab" data-sub="analitico" onclick="alternarSubAbaFluxo('analitico', this)">üóíÔ∏è
                Anal√≠tico</button>
              <button class="btn-small-tab active" data-sub="geral" onclick="alternarSubAbaFluxo('geral', this)">üìä
                Geral</button>
              <button class="btn-small-tab" data-sub="fechamento" onclick="alternarSubAbaFluxo('fechamento', this)">üîí
                Fechamento</button>
            </div>

            <div id="containerAgrupamentoFluxo"
              style="display: flex; gap: 8px; background: #f1f5f9; padding: 5px; border-radius: 10px; height: 45px; align-items: center;">
              <button class="btn-small-tab active" onclick="carregarRelatorioFluxo('dia', this)">Dia</button>
              <button class="btn-small-tab" onclick="carregarRelatorioFluxo('semana', this)">Semana</button>
              <button class="btn-small-tab" onclick="carregarRelatorioFluxo('mes', this)">M√™s</button>
            </div>
          </div>

          <!-- SUB-ABA GERAL -->
          <div id="subAbaFluxoGeral">
            <div style="margin-bottom: 40px;">
              <h4 style="margin: 0 0 15px 0; color: #10b981; display:flex; align-items:center; gap:8px;">
                <span style="background:#dcfce7; padding:5px; border-radius:6px;">üìà</span> Pivot: Entradas por Forma
              </h4>
              <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-x: auto;">
                <table id="tabelaPivotEntradas" style="width: 100%; border-collapse: collapse; min-width: 600px;">
                </table>
              </div>
            </div>
            <div>
              <h4 style="margin: 0 0 15px 0; color: #ef4444; display:flex; align-items:center; gap:8px;">
                <span style="background:#fee2e2; padding:5px; border-radius:6px;">üìâ</span> Pivot: Sa√≠das por Recebedor
              </h4>
              <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-x: auto;">
                <table id="tabelaPivotSaidas" style="width: 100%; border-collapse: collapse; min-width: 600px;"></table>
              </div>
            </div>
          </div>

          <!-- SUB-ABA ANAL√çTICO -->
          <div id="subAbaFluxoAnalitico" class="hidden">
            <div style="display: grid; grid-template-rows: auto auto; gap: 30px;">
              <div>
                <h4 style="margin: 0 0 10px 0; color: #10b981; display:flex; align-items:center; gap:8px;">
                  <span style="background:#dcfce7; padding:5px; border-radius:6px;">üìã</span> Detalhamento de Entradas
                </h4>
                <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto; max-height: 250px;">
                  <table style="width: 100%; border-collapse: collapse;">
                    <thead style="background: #f8fafc; position: sticky; top: 0; z-index: 10;">
                      <tr>
                        <th style="padding: 10px; text-align: left; cursor: pointer; width: 150px; white-space: nowrap;"
                          onclick="ordenarAnaliticoFluxo('entradas', 'data')">Data ‚ÜïÔ∏è</th>
                        <th style="padding: 10px; text-align: left;">Fonte/Venda</th>
                        <th style="padding: 10px; text-align: left;">M√©todo</th>
                        <th style="padding: 10px; text-align: right; width: 120px;">Valor (R$)</th>
                      </tr>
                    </thead>
                    <tbody id="tabelaFluxoAnaliticoEntradas"></tbody>
                  </table>
                </div>
              </div>
              <div>
                <h4 style="margin: 0 0 10px 0; color: #ef4444; display:flex; align-items:center; gap:8px;">
                  <span style="background:#fee2e2; padding:5px; border-radius:6px;">üìã</span> Detalhamento de Sa√≠das
                </h4>
                <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto; max-height: 250px;">
                  <table style="width: 100%; border-collapse: collapse;">
                    <thead style="background: #f8fafc; position: sticky; top: 0; z-index: 10;">
                      <tr>
                        <th style="padding: 10px; text-align: left; cursor: pointer; width: 150px; white-space: nowrap;"
                          onclick="ordenarAnaliticoFluxo('saidas', 'data')">Data ‚ÜïÔ∏è</th>
                        <th style="padding: 10px; text-align: left;">Recebedor</th>
                        <th style="padding: 10px; text-align: left;">Servi√ßo/Item</th>
                        <th style="padding: 10px; text-align: right; width: 120px;">Valor (R$)</th>
                      </tr>
                    </thead>
                    <tbody id="tabelaFluxoAnaliticoSaidas"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- SUB-ABA FECHAMENTO FLUXO -->
          <div id="subAbaFluxoFechamento" class="hidden">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
              <div>
                <h4 style="margin: 0 0 15px 0; color: #10b981; display:flex; align-items:center; gap:8px;">
                  <span style="background:#dcfce7; padding:5px; border-radius:6px;">üìà</span> Resumo de Entradas
                  (Recebimentos)
                </h4>
                <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto;">
                  <table style="width: 100%; border-collapse: collapse;">
                    <thead style="background: #f8fafc; z-index: 10;">
                      <tr>
                        <th style="padding: 10px; text-align: left;">M√©todo</th>
                        <th style="padding: 10px; text-align: right; width: 150px;">Total (R$)</th>
                      </tr>
                    </thead>
                    <tbody id="tabelaFechamentoFluxoEntradasBody"></tbody>
                    <tfoot style="background: #f8fafc; border-top: 2px solid #e2e8f0; font-weight: 800;">
                      <tr>
                        <td style="padding: 12px;">TOTAL ENTRADAS</td>
                        <td id="totalFechamentoFluxoEntradas" style="text-align: right; padding-right: 10px;">R$ 0,00
                        </td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              </div>
              <div>
                <h4 style="margin: 0 0 15px 0; color: #ef4444; display:flex; align-items:center; gap:8px;">
                  <span style="background:#fee2e2; padding:5px; border-radius:6px;">üìâ</span> Resumo de Sa√≠das
                  (Pagamentos)
                </h4>
                <div style="border: 1px solid #f1f5f9; border-radius: 12px; overflow-y: auto;">
                  <table style="width: 100%; border-collapse: collapse;">
                    <thead style="background: #f8fafc; z-index: 10;">
                      <tr>
                        <th style="padding: 10px; text-align: left;">M√©todo</th>
                        <th style="padding: 10px; text-align: right; width: 150px;">Total (R$)</th>
                      </tr>
                    </thead>
                    <tbody id="tabelaFechamentoFluxoSaidasBody"></tbody>
                    <tfoot style="background: #f8fafc; border-top: 2px solid #e2e8f0; font-weight: 800;">
                      <tr>
                        <td style="padding: 12px;">TOTAL SA√çDAS</td>
                        <td id="totalFechamentoFluxoSaidas" style="text-align: right; padding-right: 10px;">R$ 0,00</td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              </div>
            </div>
            <div
              style="margin-top: 25px; background: #f8fafc; padding: 20px; border-radius: 12px; border: 2px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
              <h3 style="margin: 0; color: #1e293b; font-family: 'Outfit', sans-serif;">SALDO FINAL DO PER√çODO</h3>
              <p id="saldoFinalFluxo" style="margin: 0; font-size: 1.8rem; font-weight: 800; color: #3b82f6;">R$ 0,00
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- MODAL SELECAO IMPRESSAO FECHAMENTO -->
  <div id="modalImpressaoFechamento" class="modal hidden">
    <div class="modal-content" style="max-width: 400px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0; font-size: 1.2rem;">O que deseja imprimir?</h2>
        <button onclick="document.getElementById('modalImpressaoFechamento').classList.add('hidden')"
          style="background: #ef4444; color: white; border-radius: 50%; width: 32px; height: 32px; padding: 0; min-width: 32px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; border: none; cursor: pointer; box-shadow: none;">√ó</button>
      </div>
      <div style="display: flex; flex-direction: column; gap: 15px;">
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
          <input type="checkbox" id="checkPrintVendas" checked style="width: 20px; height: 20px;">
          <span>Vendas (Itens e Qtd)</span>
        </label>
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
          <input type="checkbox" id="checkPrintPagamentos" checked style="width: 20px; height: 20px;">
          <span>Pagamentos (Sa√≠das)</span>
        </label>
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
          <input type="checkbox" id="checkPrintRecebimentosSistema" checked style="width: 20px; height: 20px;">
          <span>Recebimentos (Sistema)</span>
        </label>
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
          <input type="checkbox" id="checkPrintRecebimentosManual" checked style="width: 20px; height: 20px;">
          <span>Recebimento (Manual)</span>
        </label>
      </div>
      <div style="margin-top: 25px; display: flex; flex-direction: column; gap: 10px;">
        <button id="btnImprimirFechamentoFinal"
          style="background: #10b981; color: white; padding: 12px; font-weight: 700; border-radius: 8px; border: none; cursor: pointer;">Imprimir
          Fechamento (F9)</button>
      </div>
    </div>
  </div>

  <!-- TEMPLATE IMPRESSAO LINGUICAO FECHAMENTO -->
  <div id="printFechamentoDiario" class="global-print-element"
    style="width: 80mm; font-family: 'Courier New', Courier, monospace; padding: 0 2mm;">
    <h2 style="text-align: center; margin-bottom: 5px;">FECHAMENTO DI√ÅRIO</h2>
    <p id="printFechamentoData"
      style="text-align: center; font-size: 9pt; margin-bottom: 10px; border-bottom: 1pt solid black; padding-bottom: 5px;">
    </p>

    <div id="printBlocoVendas">
      <h3 style="font-size: 10pt; border-bottom: 1pt dashed black; margin-top: 10px; margin-bottom: 5px;">VENDAS POR
        ITEM</h3>
      <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
        <thead>
          <tr style="border-bottom: 0.5pt solid #eee;">
            <th style="text-align: left;">ITEM</th>
            <th style="text-align: right;">QTD</th>
          </tr>
        </thead>
        <tbody id="printBodyVendas"></tbody>
      </table>
    </div>

    <div id="printBlocoPagamentos">
      <h3 style="font-size: 10pt; border-bottom: 1pt dashed black; margin-top: 10px; margin-bottom: 5px;">PAGAMENTOS
        (SA√çDAS)</h3>
      <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
        <thead>
          <tr style="border-bottom: 0.5pt solid #eee;">
            <th style="text-align: left;">RECEBEDOR</th>
            <th style="text-align: right;">VALOR</th>
          </tr>
        </thead>
        <tbody id="printBodyPagamentos"></tbody>
      </table>
    </div>

    <div id="printBlocoRecebimentosSistema">
      <h3 style="font-size: 10pt; border-bottom: 1pt dashed black; margin-top: 10px; margin-bottom: 5px;">RECEBIMENTOS
        (SISTEMA)</h3>
      <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
        <thead>
          <tr style="border-bottom: 0.5pt solid #eee;">
            <th style="text-align: left;">M√âTODO</th>
            <th style="text-align: right;">VALOR</th>
          </tr>
        </thead>
        <tbody id="printBodyRecebimentosSistema"></tbody>
      </table>
    </div>

    <div id="printBlocoRecebimentosManual">
      <h3 style="font-size: 10pt; border-bottom: 1pt dashed black; margin-top: 10px; margin-bottom: 5px;">RECEBIMENTOS
        (MANUAL)</h3>
      <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
        <thead>
          <tr style="border-bottom: 0.5pt solid #eee;">
            <th style="text-align: left;">FORMA</th>
            <th style="text-align: right;">VALOR</th>
          </tr>
        </thead>
        <tbody id="printBodyRecebimentosManual"></tbody>
      </table>
    </div>

    <div style="margin-top: 20px; border-top: 1pt solid black; text-align: center; padding-top: 10px;">
      <p style="font-size: 8pt;">Conferido por: __________________</p>
    </div>
  </div>

  <aside class="sidebar-right collapsed">
    <div class="sidebar-content-right">
      <button id="btnToggleRightSidebar" class="btn-toggle" title="Alternar Resumo">
        <i class="fas fa-bars"></i>
      </button>

      <div class="brand-text" style="margin-bottom: 20px;">
        <h3 style="font-family: 'Outfit', sans-serif; font-size: 1.1rem; color: #1e293b; margin: 0;">Resumo Hoje</h3>
        <p style="font-size: 0.75rem; color: #64748b; margin: 5px 0 0 0;">Dados em tempo real</p>
      </div>

      <div class="stats-overview">
        <div class="stat-card">
          <div class="stat-icon" style="background: #f0fdf4; color: #10b981;">‚úÖ</div>
          <div class="stat-info">
            <h4>Dispon√≠veis</h4>
            <p id="stats-livres">--</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon" style="background: #fef2f2; color: #ef4444;">üçΩÔ∏è</div>
          <div class="stat-info">
            <h4>Em Uso</h4>
            <p id="stats-ocupadas">--</p>
          </div>
        </div>
      </div>

      <!-- Itens Vendidos Hoje (Recolh√≠vel) -->
      <div style="margin-top: 20px; border-top: 1px solid #e2e8f0; padding-top: 15px;">
        <div id="toggleVendasHojeBtn"
          style="display: flex; justify-content: space-between; align-items: center; cursor: pointer; padding: 10px; background: #f8fafc; border-radius: 8px; gap: 8px;">
          <span style="font-size: 1.2rem;">üì¶</span>
          <span class="vendas-label" style="font-weight: 700; color: #1e293b; font-size: 0.9rem; flex: 1;">Itens
            Vendidos Hoje</span>
          <span id="toggleVendasIcon" style="font-size: 1rem; transition: transform 0.3s;">‚ñº</span>
        </div>
        <div id="vendasHojeContainer" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out;">
          <div
            style="margin-top: 10px; max-height: 300px; overflow-y: auto; border: 1px solid #f1f5f9; border-radius: 8px;">
            <table style="width: 100%; border-collapse: collapse; font-size: 0.8rem;">
              <thead style="background: #f8fafc; position: sticky; top: 0;">
                <tr>
                  <th style="padding: 8px; text-align: left; color: #64748b;">Produto</th>
                  <th style="padding: 8px; text-align: center; color: #64748b; width: 60px;">Qtd</th>
                </tr>
              </thead>
              <tbody id="tbodyVendasHoje">
                <tr>
                  <td colspan="2" style="padding: 15px; text-align: center; color: #94a3b8;">Carregando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <!-- MODAL DE ATENDIMENTO (COMANDA) -->
  <div id="modalComanda" class="modal hidden">
    <div class="modal-content">
      <div class="comanda-header">
        <h2 id="tituloComanda">Comanda</h2>
        <div class="comanda-info">
          <div class="info-field">
            <label>Nome:</label>
            <input type="text" id="nomeComanda" placeholder="Nome do cliente" autocomplete="off">
          </div>
          <div class="info-field">
            <label>Telefone:</label>
            <input type="text" id="telefoneComanda" placeholder="Telefone" autocomplete="off">
          </div>
          <div class="info-field">
            <label>Pessoas:</label>
            <input type="text" id="pessoasComanda" placeholder="Qtde" style="min-width: 60px;">
          </div>
        </div>
        <button id="btnFecharModalComanda"
          style="background: #ef4444; border-radius: 50%; width: 36px; height: 36px; padding: 0; min-width: 36px;">√ó</button>
      </div>

      <div class="pdv-layout">
        <!-- COLUNA ESQUERDA -->
        <div class="pdv-comanda">
          <div class="entrada-produto">
            <input id="buscaCodigo" placeholder="C√≥digo" autocomplete="off" style="width: 80px;">
            <input id="buscaDescricao" placeholder="Descri√ß√£o" autocomplete="off" style="flex: 1;">
            <input id="qtdProduto" type="number" step="1" placeholder="Qtd" style="width: 70px;">
            <input id="valorProduto" type="number" step="0.01" placeholder="Valor" readonly style="width: 90px;">

          </div>

          <div id="itensComanda">
            <table id="tabelaItens">
              <thead>
                <tr>
                  <th>C√≥d</th>
                  <th>Descri√ß√£o</th>
                  <th>Qtd</th>
                  <th>R$ Valor</th>
                  <th>R$ Subtotal</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
            <div id="totalComanda"></div>
          </div>
        </div>

        <!-- COLUNA DIREITA -->
        <div class="pdv-produtos">
          <div class="produtos-header" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; gap: 20px;">
              <span>COD</span>
              <span>Produtos</span>
              <span>Valor</span>
            </div>
            <button id="btnAbrirModalCadastroComanda"
              style="background: #3b82f6; padding: 4px 10px; font-size: 0.75rem; border-radius: 6px; margin: 0;">+
              Novo (F3)</button>
          </div>
          <div id="listaProdutos"></div>
        </div>
      </div>

      <div class="pdv-atalhos" style="margin-top: 20px; border-top: 1px solid #e2e8f0; padding-top: 15px;">
        <button id="btnImprimirModal">Imprimir (F9)</button>
        <button id="btnDividirItemModal">Divis√£o por item (F4)</button>
        <label style="display: flex; align-items: center; gap: 10px; font-weight: 600;">
          Divis√£o por:
          <span id="qtdPessoas" style="min-width: 40px; text-align: center; font-weight: 800; color: #1e293b;">1</span>
          <span id="valorPorPessoa" style="color: #ef4444;">R$ 0,00</span>
        </label>
        <button id="btnPagamentoModal" style="background: #10b981;">Pagamento (F8)</button>
      </div>
    </div>
  </div>

  <!-- MODAL DIVIDIR POR ITEM -->
  <div id="modalDividirItem" class="modal hidden">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3 style="margin: 0;" class="screen-only">Dividir por item</h3>
        <h2 id="tituloPartialPrint" class="print-only"
          style="display:none; text-align:center; width:100%; margin:0 0 10px 0; font-family:'Outfit', sans-serif;">
        </h2>
        <button onclick="document.getElementById('modalDividirItem').classList.add('hidden')"
          style="background: #ef4444; border-radius: 50%; width: 36px; height: 36px; padding: 0; min-width: 36px; color: white; border: none; cursor: pointer;">√ó</button>
      </div>
      <div style="max-height: 400px; overflow-y: auto;">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="background: #f1f5f9;">
              <th style="padding: 10px;">C√≥d</th>
              <th>Descri√ß√£o</th>
              <th style="text-align: center;">Total</th>
              <th style="text-align: center;">Pago</th>
              <th style="text-align: center;">Restante</th>
              <th style="text-align: center;">
                <span class="screen-only">Considerar</span>
                <span class="print-only" style="display:none;">Qtd</span>
              </th>
              <th>
                <span class="screen-only">Valor</span>
                <span class="print-only" style="display:none;">R$ Valor</span>
              </th>
              <th>
                <span class="screen-only">Subtotal</span>
                <span class="print-only" style="display:none;">R$ Subtotal</span>
              </th>
            </tr>
          </thead>
          <tbody id="tbodyDivisaoItens"></tbody>
        </table>
      </div>
      <div class="modal-actions" style="display: flex; justify-content: space-between; align-items: center;">
        <div style="font-size: 1.25rem; font-weight: 800; color: #3b82f6;" id="footerTotalDivisao">
          <span class="screen-only">TOTAL SELECIONADO:</span>
          <span class="print-only" style="display:none;">TOTAL:</span>
          <span id="totalSelecionadoItem">R$ 0,00</span>
        </div>
        <div style="display: flex; gap: 10px;">
          <button id="btnConsiderarSelecao" style="background: var(--primary);">Considerar Sele√ß√£o (F5)</button>
          <button id="btnAdicionarAoPagamento" style="background: #10b981;">Gerar Pagamento (F8)</button>
          <button id="btnImprimirDivisao" style="background: #3b82f6;">Imprimir (F9)</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL DE PAGAMENTO -->
  <div id="modalPagamento" class="modal hidden">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2 id="tituloPagamentoModal">Pagamento Comanda</h2>
        <button id="btnFecharModalPagamento"
          style="background: #ef4444; border-radius: 50%; width: 36px; height: 36px; padding: 0; min-width: 36px;">√ó</button>
      </div>
      <div class="pagamento-grid">
        <div class="col-form">
          <div class="form-pagamento" style="border: 1px solid #e2e8f0; padding: 15px; border-radius: 12px;">
            <div class="metodos-pagamento"
              style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 15px; margin-bottom: 15px;">
              <button class="metodo-btn active" data-forma="Cart√£o Cr√©dito">üí≥ Cr√©dito</button>
              <button class="metodo-btn" data-forma="Cart√£o D√©bito">üè¶ D√©bito</button>
              <button class="metodo-btn" data-forma="Pix">üí† Pix</button>
              <button class="metodo-btn" data-forma="Dinheiro">üíµ Dinheiro</button>
              <button class="metodo-btn" data-forma="Abatimento">üìâ Abatimento</button>
              <button class="metodo-btn" data-forma="Voucher">üé´ Voucher</button>
            </div>
            <div class="valor-input-container">
              <label style="display: block; font-weight: 700; margin-bottom: 5px;">VALOR A LAN√áAR</label>
              <input type="number" id="valorPagamentoInput" step="0.01"
                style="width: 100%; font-size: 1.5rem; font-weight: 800; text-align: right; color: #3b82f6;">
            </div>
            <button id="btnLancarPagamentoModal"
              style="width: 100%; margin-top: 15px; height: 50px; font-size: 1.1rem;">Lan√ßar Pagamento (Enter)</button>
            <button id="btnVoltarDivisaoModal"
              style="width: 100%; margin-top: 8px; height: 40px; font-size: 0.95rem; background: #64748b;">Voltar p/
              Divis√£o (F4)</button>
          </div>
        </div>
        <div class="col-resumo">
          <div class="lista-pagamentos"
            style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 10px; min-height: 200px; max-height: 300px; overflow-y: auto;">
            <table id="tabelaPagamentosModal" style="width: 100%;">
              <thead>
                <tr style="font-size: 0.75rem; color: #64748b; text-transform: uppercase;">
                  <th style="text-align: left;">Forma</th>
                  <th style="text-align: right;">Valor</th>
                  <th style="width: 40px;"></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="resumo-comanda-pagamento" style="margin-top: 15px;">
            <div class="resumo-item-pag"><span>Total Comanda</span> <span id="pag-total-comanda">R$ 0,00</span></div>
            <div class="resumo-item-pag"><span>Total Pago</span> <span id="pag-total-pago" style="color: #3b82f6;">R$
                0,00</span></div>
            <div class="total-pagar-pag"><span>A PAGAR</span> <span id="pag-saldo-devedor">R$ 0,00</span></div>
          </div>
          <button id="btnFinalizarComandaModal" class="btn-finalizar"
            style="background: #22c55e; height: 55px; font-size: 1.2rem; margin-top: 15px; border-radius: 8px;">Finalizar
            (F10)</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL CADASTRO PRODUTO -->
  <div id="modalCadastroProduto" class="modal hidden">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2>Cadastro de Produtos</h2>
        <button id="btnFecharModalCadastro"
          style="background: #ef4444; border-radius: 50%; width: 36px; height: 36px; padding: 0; min-width: 36px;">√ó</button>
      </div>
      <div class="form-cadastro">
        <div class="campos-linha">
          <input id="novoCodigo" placeholder="C√≥digo" style="width: 100px;">
          <input id="novaDescricao" placeholder="Descri√ß√£o" style="flex: 1;">
          <input id="valorNovoProduto" placeholder="Valor" type="number" step="0.01" style="width: 120px;">
          <button id="btnSalvarProdutoModal" style="background: #10b981;">Salvar Produto (F5)</button>
        </div>
      </div>
      <div style="max-height: 50vh; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 12px;">
        <table id="tabelaProdutosModal" style="width: 100%;">
          <thead style="background: #f8fafc; position: sticky; top: 0;">
            <tr>
              <th style="padding: 12px; border-radius: 12px 0 0 0;">Grupo</th>
              <th>C√≥d</th>
              <th>Descri√ß√£o</th>
              <th>Valor</th>
              <th style="text-align: center;">Ativo</th>
              <th style="text-align: center; border-radius: 0 12px 0 0;">Excluir</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Utilit√°rios base -->
  <script src="js/api.js?v=3"></script>
  <script src="js/utils.js?v=3"></script>
  <script src="js/printer.js?v=1"></script>

  <!-- Novos m√≥dulos (refatora√ß√£o completa) -->
  <script src="js/dashboard.js?v=2"></script>
  <script src="js/produtos.js?v=2"></script>
  <script src="js/comanda.js?v=2"></script>
  <script src="js/divisao.js?v=1"></script>
  <script src="js/pagamento.js?v=1"></script>
  <script src="js/impressao.js?v=1"></script>
  <script src="js/fechamento.js?v=1"></script>

  <!-- M√≥dulo principal (orquestrador) -->
  <script src="js/index.js?v=4"></script>

  <!-- M√≥dulos secund√°rios -->
  <script src="js/colaboradores.js?v=3"></script>
  <script src="js/financeiro.js?v=3"></script>
  <script src="js/relatorios.js?v=3"></script>

  <div id="printResumoPagamento" class="global-print-element"
    style="width: 80mm; font-family: 'Courier New', Courier, monospace; padding: 0 2mm;">
    <h3 style="text-align: center; margin: 2mm 0; border-bottom: 1pt dashed black; padding-bottom: 2mm;">RESUMO DE
      PAGAMENTO</h3>
    <div id="printResumoInfo" style="margin-bottom: 3mm; font-size: 9pt; text-align: center; line-height: 1.4;"></div>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 2mm;">
      <thead>
        <tr style="border-bottom: 1pt solid black;">
          <th style="text-align: left; padding: 1mm 0; font-size: 9pt; width: 60%;">FORMA</th>
          <th style="text-align: right; padding: 1mm 0; font-size: 9pt; width: 40%;">VALOR</th>
        </tr>
      </thead>
      <tbody id="printResumoPagamentoBody" style="font-size: 9pt;"></tbody>
    </table>
    <div id="printResumoTotal"
      style="text-align: right; font-weight: 800; border-top: 1pt solid black; padding-top: 2mm; font-size: 11pt; margin-bottom: 2mm;">
    </div>
  </div>

  <!-- TEMPLATE IMPRESS√ÉO ITENS PARCIAIS (DIVIS√ÉO) -->
  <div id="printItensParciais" class="global-print-element"
    style="width: 80mm; font-family: 'Courier New', Courier, monospace; padding: 0 2mm; display: none;">
    <h2 id="printParciaisTitulo" style="text-align: center; margin: 2mm 0; font-size: 12pt;"></h2>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 2mm;">
      <thead>
        <tr style="border-bottom: 1pt solid black;">
          <th style="text-align: left; padding: 1mm 0; font-size: 9pt;">ITEM</th>
          <th style="text-align: center; padding: 1mm 0; font-size: 9pt; width: 30px;">QTD</th>
          <th style="text-align: right; padding: 1mm 0; font-size: 9pt; width: 60px;">VALOR</th>
        </tr>
      </thead>
      <tbody id="printParciaisBody" style="font-size: 9pt;"></tbody>
    </table>
    <div id="printParciaisTotal"
      style="text-align: right; font-weight: 800; border-top: 1pt solid black; padding-top: 2mm; font-size: 11pt; margin-bottom: 2mm;">
    </div>
  </div>

  <div id="globalPrintFooter" class="global-print-element">
    <div class="footer-item"><i class="fab fa-instagram"></i> @restauranteranchojp</div>
    <div class="footer-item"><i class="fab fa-whatsapp"></i> (16) 991211765</div>
    <!-- Quebras de linha para facilitar o destaque do papel sem cortar o conte√∫do -->
    <div class="print-only" style="display: none;"><br><br><br><br><br></div>
  </div>
</body>

</html>